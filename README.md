# 远程控制系统 v1.0 完整使用手册

<div align="center">

![Version](https://img.shields.io/badge/version-2.9-blue.svg)
![Python](https://img.shields.io/badge/python-3.7+-green.svg)
![License](https://img.shields.io/badge/license-MIT-orange.svg)
![Platform](https://img.shields.io/badge/platform-Windows-lightgrey.svg)

**功能强大的 Windows 远程控制系统**

[快速开始](#快速开始) • [功能特性](#功能特性) • [安装部署](#安装部署) • [使用说明](#使用说明) • [常见问题](#常见问题)

</div>

---

## 📋 目录

- [系统简介](#系统简介)
- [功能特性](#功能特性)
- [系统架构](#系统架构)
- [环境要求](#环境要求)
- [快速开始](#快速开始)
- [安装部署](#安装部署)
- [使用说明](#使用说明)
- [文件管理](#文件管理)
- [远程控制](#远程控制)
- [批处理脚本](#批处理脚本)
- [配置文件](#配置文件)
- [打包发布](#打包发布)
- [开机自启](#开机自启)
- [常见问题](#常见问题)
- [技术支持](#技术支持)

---

## 🎯 系统简介

远程控制系统是一个基于 Python 开发的跨网络远程管理工具，采用客户端-服务器-控制端三层架构，支持多台计算机的集中管理和控制。

### 核心优势

- ✅ **功能完整** - 屏幕监控、远程控制、文件管理、批量命令
- ✅ **操作简便** - 图形化界面，一键操作，无需复杂配置
- ✅ **性能优秀** - 视频质量可调，网络传输优化，资源占用低
- ✅ **稳定可靠** - 自动重连机制，完整的异常处理，生产级代码质量
- ✅ **安全可控** - 支持管理员权限，自定义主机名，连接状态实时监控

---

## ✨ 功能特性

### 📁 文件管理（9项功能）

| 功能 | 说明 | 快捷操作 |
|------|------|----------|
| 📂 浏览文件 | 查看远程文件列表，支持所有磁盘 | 选择磁盘 → 浏览 |
| 🔍 双击进入 | 双击文件夹进入子目录 | 双击文件夹 |
| ⬆️ 双击返回 | 双击".."返回上级目录 | 双击".." |
| 👁️ **打开查看** | 直接查看文件内容（v1.0新增） | 右键 → 打开查看 |
| ⬇️ 下载文件 | 下载文件到本地 | 右键 → 下载 |
| ⬆️ 上传文件 | 上传文件到远程 | 右键 → 上传 |
| 🗑️ 删除文件 | 删除文件或文件夹 | 右键 → 删除 |
| 📁 新建文件夹 | 创建新文件夹 | 右键 → 新建 |
| 🔄 自动刷新 | 操作后自动刷新列表 | 自动执行 |

### 🖥️ 远程控制（7项功能）

| 功能 | 说明 | 操作方式 |
|------|------|----------|
| 📸 屏幕截图 | 获取远程屏幕截图 | 点击"截图" |
| 🎥 视频监控 | 实时查看远程屏幕 | 点击"开始视频" |
| 🎚️ 质量调节 | 5档视频质量可选 | 选择质量档位 |
| 🖱️ 鼠标控制 | 远程控制鼠标移动和点击 | 点击"鼠标控制" |
| ⌨️ 键盘控制 | 远程控制键盘输入 | 点击"键盘控制" |
| 📝 批量命令 | 批量执行系统命令 | 输入命令 → 执行 |
| 🔄 自动重连 | 断线自动重连 | 自动执行 |

### 🔧 系统管理

- ✅ 多主机管理 - 同时管理多台计算机
- ✅ 自定义名称 - 为每台主机设置固定标识
- ✅ 状态监控 - 实时显示连接状态和心跳
- ✅ 日志记录 - 详细的操作日志和错误提示
- ✅ 开机自启 - 支持3种自启动方式
- ✅ 管理员权限 - 支持以管理员身份运行

---

## 🏗️ 系统架构

```
┌─────────────┐         ┌─────────────┐         ┌─────────────┐
│             │         │             │         │             │
│  控制端     │◄───────►│   服务器    │◄───────►│   被控端    │
│ Controller  │         │   Server    │         │   Agent     │
│             │         │             │         │             │
└─────────────┘         └─────────────┘         └─────────────┘
     GUI界面                消息转发               后台运行
   操作发起端              中央枢纽              命令执行端
```

### 组件说明

1. **服务器端 (Server)**
   - 作用：消息转发中心
   - 运行位置：公网服务器或局域网中心
   - 端口：默认 5000

2. **被控端 (Agent)**
   - 作用：接收并执行控制命令
   - 运行位置：需要被控制的计算机
   - 模式：后台静默运行

3. **控制端 (Controller)**
   - 作用：发送控制命令，查看执行结果
   - 运行位置：管理员的计算机
   - 界面：PyQt5 图形界面

---

## 💻 环境要求

### 系统要求

- **操作系统**: Windows 7/8/10/11 (64位)
- **Python**: 3.7 或更高版本
- **内存**: 最低 2GB RAM
- **网络**: 支持 TCP 连接

### 依赖包

```
PyQt5>=5.15.0        # GUI界面
Pillow>=8.0.0        # 图像处理
pyinstaller>=4.0     # 打包工具（可选）
```

---

## 🚀 快速开始

### 方式一：使用 Python 脚本（开发模式）

```bash
# 1. 安装依赖
install.bat

# 2. 启动服务器（在服务器上运行）
python server.py

# 3. 启动被控端（在需要被控的电脑上运行）
python agent.py

# 4. 启动控制端（在管理员电脑上运行）
python controller.py
```

### 方式二：使用 EXE 文件（生产模式）

```bash
# 1. 打包所有程序
666.bat

# 2. 在服务器上运行
release\RemoteServer.exe

# 3. 在被控端配置并运行
配置被控端.bat
release\RemoteAgent.exe

# 4. 在控制端运行
release\RemoteController.exe
```

---

## 📦 安装部署

### 步骤 1: 安装 Python 环境

1. 下载 Python 3.7+ 
2. 安装时勾选 "Add Python to PATH"
3. 验证安装：`python --version`

### 步骤 2: 安装依赖包

双击运行 `install.bat` 或手动执行：

```bash
pip install -r requirements.txt
```

### 步骤 3: 配置服务器

编辑 `config.ini`：

```ini
[Server]
port = 5000
```

### 步骤 4: 配置被控端

运行 `配置被控端.bat` 或手动创建 `agent_config.ini`：

```ini
[Server]
ip = 192.168.1.100    # 服务器IP
port = 5000           # 服务器端口

[Agent]
name = 办公室电脑-01   # 自定义主机名
```

### 步骤 5: 启动系统

```bash
# 服务器
python server.py

# 被控端
python agent.py --config agent_config.ini --silent

# 控制端
python controller.py
```

---

## 📖 使用说明

### 控制端界面说明

```
┌────────────────────────────────────────────────────────┐
│  远程控制系统 v1.0                                      │
├────────────────────────────────────────────────────────┤
│  服务器连接                                             │
│  ┌──────────────┐  ┌──────┐  ┌──────┐                 │
│  │ 127.0.0.1    │  │ 5000 │  │ 连接 │                 │
│  └──────────────┘  └──────┘  └──────┘                 │
├────────────────────────────────────────────────────────┤
│  主机列表                                               │
│  ┌────────────────────────────────────────────────┐   │
│  │ ☑ 办公室电脑-01  [在线] 心跳: 2s前              │   │
│  │ ☑ 会议室电脑-02  [在线] 心跳: 1s前              │   │
│  └────────────────────────────────────────────────┘   │
├────────────────────────────────────────────────────────┤
│  功能选项卡                                             │
│  [屏幕监控] [远程控制] [文件管理] [批量命令]           │
├────────────────────────────────────────────────────────┤
│  操作区域                                               │
│  ...                                                   │
├────────────────────────────────────────────────────────┤
│  日志输出                                               │
│  [22:30:15] ✅ 连接成功!                               │
│  [22:30:20] 📸 截图成功                                │
└────────────────────────────────────────────────────────┘
```

### 连接服务器

1. 输入服务器 IP 地址
2. 输入服务器端口（默认 5000）
3. 点击"连接服务器"
4. 等待连接成功提示

### 选择主机

- 单选：点击主机名前的复选框
- 多选：点击多个主机的复选框
- 全选：点击"全选"按钮

---

## 📁 文件管理

### 浏览文件

1. 选择一台主机
2. 切换到"文件管理"选项卡
3. 选择磁盘（C:、D:、E: 等）
4. 双击文件夹进入子目录
5. 双击".."返回上级目录

### 打开查看文件 🆕

**适用场景**：快速查看文本文件内容，无需下载

**操作步骤**：
1. 右键点击文件
2. 选择"👁️ 打开查看"
3. 在弹出窗口中查看内容
4. 可以复制全部或另存为

**支持的文件类型**：
- 文本文件：.txt, .log, .ini, .conf
- 代码文件：.py, .js, .html, .css, .java
- 配置文件：.json, .xml, .yaml, .yml
- 其他文本文件

**注意事项**：
- 文件大小限制：10MB
- 二进制文件会显示乱码
- 使用 UTF-8 解码

### 下载文件

1. 右键点击文件
2. 选择"⬇️ 下载文件"
3. 选择保存位置
4. 等待下载完成

### 上传文件

1. 右键点击空白处
2. 选择"⬆️ 上传文件"
3. 选择要上传的文件
4. 等待上传完成

### 删除文件

1. 右键点击文件或文件夹
2. 选择"🗑️ 删除"
3. 确认删除操作
4. 等待删除完成

**注意**：删除文件夹会删除其所有内容，请谨慎操作！

### 新建文件夹

1. 右键点击空白处
2. 选择"📁 新建文件夹"
3. 输入文件夹名称
4. 等待创建完成

**注意**：文件夹名称不能包含非法字符：`< > : " / \ | ? *`

---

## 🖥️ 远程控制

### 屏幕截图

1. 选择主机
2. 切换到"屏幕监控"选项卡
3. 点击"截图"按钮
4. 查看截图结果

### 视频监控

1. 选择主机
2. 选择视频质量（低/中/高/超高/极致）
3. 点击"开始视频"
4. 实时查看远程屏幕
5. 点击"停止视频"结束监控

**质量档位说明**：
- 低质量：640x480, 50%质量，适合网络较差
- 中质量：800x600, 60%质量，适合一般网络
- 高质量：1024x768, 70%质量，适合良好网络
- 超高质量：1280x720, 80%质量，适合优秀网络
- 极致质量：1920x1080, 90%质量，适合局域网

### 鼠标控制

1. 选择主机
2. 切换到"远程控制"选项卡
3. 点击"鼠标控制"
4. 在屏幕图像上操作：
   - 左键点击：控制远程鼠标左键
   - 右键点击：控制远程鼠标右键
   - 鼠标移动：控制远程鼠标位置
5. 点击"停止控制"结束

### 键盘控制

1. 选择主机
2. 点击"键盘控制"
3. 在控制端窗口输入内容
4. 远程计算机会同步输入
5. 点击"停止控制"结束

**支持的按键**：
- 普通字符：a-z, A-Z, 0-9
- 特殊键：Enter, Backspace, Tab, Esc, Delete
- 方向键：Up, Down, Left, Right
- 功能键：F1-F12
- 其他：Home, End, PageUp, PageDown

### 批量命令

1. 选择一个或多个主机
2. 切换到"批量命令"选项卡
3. 输入要执行的命令
4. 点击"执行命令"
5. 查看执行结果

**示例命令**：
```bash
# 查看IP配置
ipconfig

# 查看系统信息
systeminfo

# 创建文件
echo Hello > C:\test.txt

# 查看进程
tasklist

# 关闭进程
taskkill /F /IM notepad.exe
```

---

## 🔧 批处理脚本

### install.bat - 安装依赖

自动安装所有 Python 依赖包。

```bash
install.bat
```

### 666.bat - 打包所有程序

一键打包服务器、被控端、控制端为 EXE 文件。

```bash
666.bat
```

生成的文件位置：
- `release\RemoteServer.exe` - 服务器端
- `release\RemoteAgent.exe` - 被控端
- `release\RemoteController.exe` - 控制端

### 配置被控端.bat - 配置被控端

交互式配置被控端连接信息。

```bash
配置被控端.bat
```

会提示输入：
- 服务器 IP 地址
- 服务器端口
- 自定义主机名

### 设置开机自启.bat - 设置自启动

配置被控端开机自动启动。

```bash
设置开机自启.bat
```

支持3种方式：
1. 任务计划程序（推荐）
2. 注册表运行键
3. 启动文件夹

### 设置开机自启_v2.bat - 高级自启动

增强版自启动配置，支持管理员权限检测。

```bash
设置开机自启_v2.bat
```

---

## ⚙️ 配置文件

### config.ini - 服务器配置

```ini
[Server]
port = 5000    # 监听端口
```

### agent_config.ini - 被控端配置

```ini
[Server]
ip = 192.168.1.100    # 服务器IP地址
port = 5000           # 服务器端口

[Agent]
name = 我的电脑       # 自定义主机名（可选）
```

---

## 📦 打包发布

### 使用 666.bat 一键打包

```bash
666.bat
```

### 手动打包

```bash
# 进入打包目录
cd build_spec

# 打包服务器
pyinstaller --clean server.spec

# 打包被控端
pyinstaller --clean agent.spec

# 打包控制端
pyinstaller --clean controller.spec
```

### 打包配置说明

所有 `.spec` 文件位于 `build_spec` 目录：
- `server.spec` - 服务器打包配置
- `agent.spec` - 被控端打包配置
- `controller.spec` - 控制端打包配置

---

## 🔄 开机自启

### 方式一：任务计划程序（推荐）

**优点**：
- ✅ 支持管理员权限
- ✅ 最可靠的方式
- ✅ 可以设置延迟启动

**设置方法**：
```bash
设置开机自启.bat
# 选择 1
```

### 方式二：注册表运行键

**优点**：
- ✅ 设置简单
- ✅ 不需要管理员权限

**设置方法**：
```bash
设置开机自启.bat
# 选择 2
```

### 方式三：启动文件夹

**优点**：
- ✅ 最简单的方式
- ✅ 用户可见

**设置方法**：
```bash
设置开机自启.bat
# 选择 3
```

### 移除自启动

```bash
设置开机自启.bat
# 选择 4
```

---

## ❓ 常见问题

### Q1: 连接服务器失败？

**可能原因**：
1. 服务器未启动
2. IP 地址或端口错误
3. 防火墙阻止连接
4. 网络不通

**解决方法**：
1. 确认服务器已启动
2. 检查 IP 和端口配置
3. 关闭防火墙或添加例外
4. 使用 `ping` 测试网络连通性

### Q2: 被控端连接后立即断开？

**可能原因**：
1. 配置文件错误
2. 服务器版本不匹配

**解决方法**：
1. 检查 `agent_config.ini` 配置
2. 确保所有组件版本一致

### Q3: 文件操作失败或崩溃？

**已修复**：v2.8 版本已彻底修复所有文件操作崩溃问题

**如仍有问题**：
1. 检查文件路径是否正确
2. 检查文件权限
3. 查看日志输出

### Q4: 视频卡顿或延迟高？

**解决方法**：
1. 降低视频质量档位
2. 检查网络带宽
3. 关闭其他占用网络的程序

### Q5: 打开查看文件显示乱码？

**可能原因**：
1. 文件不是文本文件
2. 文件编码不是 UTF-8

**解决方法**：
1. 只查看文本文件
2. 对于其他编码的文件，建议下载后用专用工具打开

---

## 📞 技术支持

### 版本信息

- **当前版本**: v1.0
- **发布日期**: 2025-11-07
- **Python 版本**: 3.7+
- **平台**: Windows


### 联系方式

如有问题或建议，请通过以下方式联系：

- 📧 Email: yc@nb686.cn
- 💬 QQ: 2716231389
- 🌐 个人主页: https://www.nb686.cn

---

## 📄 许可证

本项目采用 MIT 许可证。

---

<div align="center">

**远程控制系统 v1.0**

Made with ❤️ by Development Team

</div>

